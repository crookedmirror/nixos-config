# show status bar only if there's more than 1 window
set-hook -g after-new-window 'if "[ #{session_windows} -gt 1 ]" "set status on"'
set-hook -g after-kill-pane 'if "[ #{session_windows} -lt 2 ]" "set status off"'
set-hook -g pane-exited 'if "[ #{session_windows} -lt 2 ]" "set status off"'
set-hook -g window-layout-changed 'if "[ #{session_windows} -lt 2 ]" "set status off"'

# https://github.com/orgs/tmux/discussions/3827
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm' 
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m' 

set -g xterm-keys on
setw -g extended-keys on
set -s focus-events on # http://superuser.com/a/252717/65504
set -s escape-time 0

run-shell ~/.config/tmux/plugins/sensible/sensible.tmux

# True color settings
set -g default-terminal "$TERM"
set -ag terminal-overrides ",$TERM:Tc"

set -g mouse off
setw -g clock-mode-style 24

setw -g mode-keys vi
set -g prefix C-S-b

# reload config
bind -n C-S-f5 source-file ~/.config/tmux/tmux.conf

# Panes
bind -n C-S-Enter split-window -v -c "#{pane_current_path}" \; select-layout

# Window navigation
set -g base-index 1 
set -g pane-base-index 1
set -g renumber-windows on

bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9

bind -n C-S-q if-shell '[ "$(tmux display-message -p "#{window_panes}")" -gt 1 ]' 'confirm-before kill-window' 'kill-window'
bind -n C-, select-window -p
bind -n C-. select-window -n
bind -n C-S-< swap-window -d -t "{previous}"
bind -n C-S-> swap-window -d -t "{next}"
bind -n C-S-t new-window -a -c "#{pane_current_path}"
